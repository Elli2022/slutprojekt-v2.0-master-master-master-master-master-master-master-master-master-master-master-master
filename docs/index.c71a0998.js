const e={imageSelection:document.getElementById("image-selection"),createAccountButton:document.getElementById("create-account-button"),submitButton:document.getElementById("submit-button"),usernameInput:document.getElementById("username"),passwordInput:document.getElementById("password"),form:document.getElementById("form"),errorMessage:document.createElement("p"),userDeletedSuccessfully:document.createElement("h1"),failedToDeleteUser:document.createElement("h1"),messageInput:document.createElement("input"),listItem:document.createElement("li"),body:document.getElementById("body"),accountCreated:document.createElement("h1"),logInpage:document.getElementById("logInpage"),container:document.getElementById("container"),currentUser:document.getElementById("current-user"),statusUpdates:document.getElementById("status-updates"),newStatusUpdate:document.getElementById("new-status-update"),addStatusUpdate:document.getElementById("add-status-update"),loggedInUsersList:document.querySelector(".js-logged-in-users-list"),otherUserPageHeader:document.querySelector(".js-other-user-page-header"),deleteAccount:document.getElementById("delete-account"),deleteAccountButton:document.getElementById("delete-account-button"),statusInput:document.getElementById("status-input"),statusUpdateButton:document.getElementById("status-update-button"),otherUserPage:document.getElementById("other-user-page"),loggedInUsersPage:document.getElementById("logged-in-users-page"),statusUpdatesList:document.getElementById("status-updates-list"),submitStatus:document.getElementById("submit-status"),allUsersList:document.getElementById("allUsersList"),userStatus:document.getElementById("userStatus")};e.logInpage&&(e.logInpage.style.display="block"),e.container.style.display="none",e.body.appendChild(e.container);document.createElement("div").className="error-message";const t="https://social-media-68d76-default-rtdb.europe-west1.firebasedatabase.app/";async function s(){try{const e=await fetch(`${t}users.json`);if(!e.ok)throw new Error(`Error: ${e.status} ${e.statusText}`);const s=await e.json();if(!s)return[];return Object.values(s)}catch(e){throw new Error("Failed to fetch users")}}async function n(e){await s();const n=`${t}users/${e.userName}.json`,r={method:"PUT",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}};try{const e=await fetch(n,r);if(!e.ok)throw new Error(`Error: ${e.status} ${e.statusText}`)}catch(e){throw console.log(e),new Error("Failed to save user information.")}}async function r(e){const s=`${t}users/${e}.json`,n={method:"DELETE"};try{const e=await fetch(s,n);if(!e.ok)throw new Error(`Error: ${e.status} ${e.statusText}`)}catch(e){throw console.log(e),new Error("Failed to delete user.")}}async function o(){const e=localStorage.getItem("loggedInUser");return e?await a(e):null}async function a(e){return(await s()).find((t=>t.userName===e))||null}async function u(){const t=e.usernameInput.value.trim(),r=e.passwordInput.value.trim();if(t&&r)try{const a=(await s()).find((e=>e.userName===t&&e.password===r));if(a){a.newUser=!1,a.status="logged-in",await n(a),localStorage.setItem("loggedInUser",a.userName),e.logInpage.style.display="none",e.container.style.display="block",e.currentUser?e.currentUser.textContent=`Logged in as: ${a.userName}`:console.error("elements.currentUser is null"),l(),async function(){const t=await s();await o();t.forEach((t=>{const s=document.createElement("li");s.textContent=`${t.userName}:`,e.loggedInUsersList&&e.loggedInUsersList.appendChild(s)}))}(),async function(){const t=await o();t&&(e.userStatus.textContent=`${t.userName}'s status: ${t.status}`)}();document.getElementById("loggedInUserHeader").textContent=`Logged in as: ${a.userName}`}else e.errorMessage.innerHTML="Incorrect username or password. Try again.",e.body.appendChild(e.errorMessage),setTimeout((()=>{e.errorMessage.remove()}),3e3)}catch(t){console.log(t),e.errorMessage.innerHTML="Failed to log in. Try again.",e.body.appendChild(e.errorMessage),setTimeout((()=>{e.errorMessage.remove()}),3e3)}else e.errorMessage.innerHTML="Please enter a username and password.",e.body.appendChild(e.errorMessage),setTimeout((()=>{e.errorMessage.remove()}),3e3);document.getElementById("backButton").style.display="block",document.getElementById("delete-account-button").style.display="block"}async function l(){const e=await o();if(e){const t=e.statusUpdates&&e.statusUpdates.slice(-1)[0]||"",s=document.getElementById("loggedInUserHeader");s?s.textContent=`Logged in as: ${e.userName} - Status: ${t}`:console.error("loggedInUserHeader element not found")}}async function d(){try{const t=await s(),n=document.createElement("ul");t.forEach((e=>{const t=document.createElement("li"),s=e.statusUpdates&&e.statusUpdates.slice(-1)[0]||"",r=document.createElement("img");r.src=e.imageurl,r.width=50,r.height=50,r.style.marginRight="10px",t.textContent=`${e.userName} - Last status: ${s}`,t.prepend(r),t.addEventListener("click",(()=>{!async function(e){const t=await a(e);if(!t)throw new Error("User not found.");const s=document.getElementById("container"),n=document.getElementById("otherUserPage");if(s&&n){s.style.display="none",n.style.display="block",n.querySelector(".username").textContent=t.userName,n.querySelector(".profile-pic").setAttribute("src",t.imageurl);const e=t.statusUpdates&&t.statusUpdates.slice(-1)[0]||"",r=n.querySelector(".user-status");if(r)r.textContent=`Status: ${e}`;else{const t=document.createElement("div");t.className="user-status",t.textContent=`Status: ${e}`;const s=n.querySelector(".profile-pic");s&&s.insertAdjacentElement("afterend",t)}}else console.error("Error: loggedInUsersPage or otherUserPage element is missing.")}(e.userName)})),n.appendChild(t)}));const r=document.createElement("div");r.id="userListWrapper",r.appendChild(n),e.allUsersList&&(e.allUsersList.innerHTML="",e.allUsersList.appendChild(r))}catch(e){console.log(e.message)}}function c(){const e=document.getElementById("container"),t=document.getElementById("otherUserPage");if(e&&t){e.style.display="block",t.style.display="none";const s=document.getElementById("userListWrapper");s&&(s.style.display="block")}else console.error("Error: loggedInUsersPage or otherUserPage element is missing.")}async function i(){const t=e.usernameInput.value.trim(),n=e.passwordInput.value.trim();if(t&&n)try{const o=(await s()).find((e=>e.userName===t&&e.password===n));o?(await r(o.userName),localStorage.removeItem("loggedInUser"),e.userDeletedSuccessfully.innerHTML="User deleted successfully!",e.body.appendChild(e.userDeletedSuccessfully),setTimeout((()=>{e.userDeletedSuccessfully.remove()}),3e3),e.usernameInput.value="",e.passwordInput.value="",e.container.style.display="none",e.logInpage.style.display="block",await d()):(e.failedToDeleteUser.innerHTML="Failed to delete user. Incorrect username or password.",e.body.appendChild(e.failedToDeleteUser),setTimeout((()=>{e.failedToDeleteUser.remove()}),3e3))}catch(t){console.log(t),e.failedToDeleteUser.innerHTML="Failed to delete user. Try again.",e.body.appendChild(e.failedToDeleteUser),setTimeout((()=>{e.failedToDeleteUser.remove()}),3e3)}else e.errorMessage.innerHTML="Please enter a username and password.",e.body.appendChild(e.errorMessage),setTimeout((()=>{e.errorMessage.remove()}),3e3);e.container.style.display="none",e.logInpage.style.display="block"}function m(){console.log("Create Account Button: ",e.createAccountButton),console.log("Submit Button: ",e.submitButton),console.log("Delete Account Button: ",e.deleteAccountButton),console.log("Submit Status: ",e.submitStatus),e.createAccountButton.addEventListener("click",(()=>{!async function(){const t=e.usernameInput.value.trim(),r=e.passwordInput.value.trim(),o=e.imageSelection.value.trim();if(t&&r&&o){(await s()).some((e=>e.userName===t));const a={userName:t,password:r,status:"",imageurl:o,newUser:!0,statusUpdates:[]};try{await n(a),e.accountCreated.innerHTML="Account Created!",e.body.appendChild(e.accountCreated),setTimeout((()=>{e.accountCreated.remove()}),3e3)}catch(t){console.log(t),e.errorMessage.innerHTML="Failed to create account. Try again.",e.body.appendChild(e.errorMessage),setTimeout((()=>{e.errorMessage.remove()}),3e3)}}else e.errorMessage.innerHTML="Please fill in all fields.",e.body.appendChild(e.errorMessage),setTimeout((()=>{e.errorMessage.remove()}),3e3)}()})),e.submitButton.addEventListener("click",(e=>{e.preventDefault(),u()})),e.deleteAccountButton.addEventListener("click",(()=>{i()})),e.submitStatus.addEventListener("click",(t=>{t.preventDefault(),async function(){const t=e.statusInput.value.trim();if(t)try{const s=await o();s?(s.statusUpdates||(s.statusUpdates=[]),s.statusUpdates.push(t),await n(s),e.statusInput.value="",l(),d()):(e.errorMessage.innerHTML="Failed to find the current user.",e.body.appendChild(e.errorMessage),setTimeout((()=>{e.errorMessage.remove()}),3e3))}catch(t){console.log(t),e.errorMessage.innerHTML="Failed to update status. Try again.",e.body.appendChild(e.errorMessage),setTimeout((()=>{e.errorMessage.remove()}),3e3)}else e.errorMessage.innerHTML="Please enter a status update.",e.body.appendChild(e.errorMessage),setTimeout((()=>{e.errorMessage.remove()}),3e3)}()}));const t=document.getElementById("backButton");t?t.addEventListener("click",c):console.error("Error: backButton element is missing.")}!async function(){document.addEventListener("DOMContentLoaded",(async()=>{m(),await d()}))}();
//# sourceMappingURL=index.c71a0998.js.map
